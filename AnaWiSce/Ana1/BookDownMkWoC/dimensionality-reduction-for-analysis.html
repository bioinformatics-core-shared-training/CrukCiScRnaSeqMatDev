<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Dimensionality reduction for analysis | CRUK Bioinformatics Summer School 2020 - single-cell RNA-seq analysis</title>
  <meta name="description" content="A report for all analyses (bookdown::gitbook)." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Dimensionality reduction for analysis | CRUK Bioinformatics Summer School 2020 - single-cell RNA-seq analysis" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="A report for all analyses (bookdown::gitbook)." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Dimensionality reduction for analysis | CRUK Bioinformatics Summer School 2020 - single-cell RNA-seq analysis" />
  
  <meta name="twitter:description" content="A report for all analyses (bookdown::gitbook)." />
  

<meta name="author" content="Stephane Ballereau, Zeynep Kalender Atak" />


<meta name="date" content="2021-03-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="batch-correction-gsm3872442-set.html"/>

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>

<script>
/* ========================================================================
 * Bootstrap: transition.js v3.3.7
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // CSS TRANSITION SUPPORT (Shoutout: http://www.modernizr.com/)
  // ============================================================

  function transitionEnd() {
    var el = document.createElement('bootstrap')

    var transEndEventNames = {
      WebkitTransition : 'webkitTransitionEnd',
      MozTransition    : 'transitionend',
      OTransition      : 'oTransitionEnd otransitionend',
      transition       : 'transitionend'
    }

    for (var name in transEndEventNames) {
      if (el.style[name] !== undefined) {
        return { end: transEndEventNames[name] }
      }
    }

    return false // explicit for ie8 (  ._.)
  }

  // http://blog.alexmaccaw.com/css-transitions
  $.fn.emulateTransitionEnd = function (duration) {
    var called = false
    var $el = this
    $(this).one('bsTransitionEnd', function () { called = true })
    var callback = function () { if (!called) $($el).trigger($.support.transition.end) }
    setTimeout(callback, duration)
    return this
  }

  $(function () {
    $.support.transition = transitionEnd()

    if (!$.support.transition) return

    $.event.special.bsTransitionEnd = {
      bindType: $.support.transition.end,
      delegateType: $.support.transition.end,
      handle: function (e) {
        if ($(e.target).is(this)) return e.handleObj.handler.apply(this, arguments)
      }
    }
  })

}(jQuery);
</script>
<script>
/* ========================================================================
 * Bootstrap: collapse.js v3.3.7
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* jshint latedef: false */

+function ($) {
  'use strict';

  // COLLAPSE PUBLIC CLASS DEFINITION
  // ================================

  var Collapse = function (element, options) {
    this.$element      = $(element)
    this.options       = $.extend({}, Collapse.DEFAULTS, options)
    this.$trigger      = $('[data-toggle="collapse"][href="#' + element.id + '"],' +
                           '[data-toggle="collapse"][data-target="#' + element.id + '"]')
    this.transitioning = null

    if (this.options.parent) {
      this.$parent = this.getParent()
    } else {
      this.addAriaAndCollapsedClass(this.$element, this.$trigger)
    }

    if (this.options.toggle) this.toggle()
  }

  Collapse.VERSION  = '3.3.7'

  Collapse.TRANSITION_DURATION = 350

  Collapse.DEFAULTS = {
    toggle: true
  }

  Collapse.prototype.dimension = function () {
    var hasWidth = this.$element.hasClass('width')
    return hasWidth ? 'width' : 'height'
  }

  Collapse.prototype.show = function () {
    if (this.transitioning || this.$element.hasClass('in')) return

    var activesData
    var actives = this.$parent && this.$parent.children('.panel').children('.in, .collapsing')

    if (actives && actives.length) {
      activesData = actives.data('bs.collapse')
      if (activesData && activesData.transitioning) return
    }

    var startEvent = $.Event('show.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    if (actives && actives.length) {
      Plugin.call(actives, 'hide')
      activesData || actives.data('bs.collapse', null)
    }

    var dimension = this.dimension()

    this.$element
      .removeClass('collapse')
      .addClass('collapsing')[dimension](0)
      .attr('aria-expanded', true)

    this.$trigger
      .removeClass('collapsed')
      .attr('aria-expanded', true)

    this.transitioning = 1

    var complete = function () {
      this.$element
        .removeClass('collapsing')
        .addClass('collapse in')[dimension]('')
      this.transitioning = 0
      this.$element
        .trigger('shown.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    var scrollSize = $.camelCase(['scroll', dimension].join('-'))

    this.$element
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)[dimension](this.$element[0][scrollSize])
  }

  Collapse.prototype.hide = function () {
    if (this.transitioning || !this.$element.hasClass('in')) return

    var startEvent = $.Event('hide.bs.collapse')
    this.$element.trigger(startEvent)
    if (startEvent.isDefaultPrevented()) return

    var dimension = this.dimension()

    this.$element[dimension](this.$element[dimension]())[0].offsetHeight

    this.$element
      .addClass('collapsing')
      .removeClass('collapse in')
      .attr('aria-expanded', false)

    this.$trigger
      .addClass('collapsed')
      .attr('aria-expanded', false)

    this.transitioning = 1

    var complete = function () {
      this.transitioning = 0
      this.$element
        .removeClass('collapsing')
        .addClass('collapse')
        .trigger('hidden.bs.collapse')
    }

    if (!$.support.transition) return complete.call(this)

    this.$element
      [dimension](0)
      .one('bsTransitionEnd', $.proxy(complete, this))
      .emulateTransitionEnd(Collapse.TRANSITION_DURATION)
  }

  Collapse.prototype.toggle = function () {
    this[this.$element.hasClass('in') ? 'hide' : 'show']()
  }

  Collapse.prototype.getParent = function () {
    return $(this.options.parent)
      .find('[data-toggle="collapse"][data-parent="' + this.options.parent + '"]')
      .each($.proxy(function (i, element) {
        var $element = $(element)
        this.addAriaAndCollapsedClass(getTargetFromTrigger($element), $element)
      }, this))
      .end()
  }

  Collapse.prototype.addAriaAndCollapsedClass = function ($element, $trigger) {
    var isOpen = $element.hasClass('in')

    $element.attr('aria-expanded', isOpen)
    $trigger
      .toggleClass('collapsed', !isOpen)
      .attr('aria-expanded', isOpen)
  }

  function getTargetFromTrigger($trigger) {
    var href
    var target = $trigger.attr('data-target')
      || (href = $trigger.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') // strip for ie7

    return $(target)
  }


  // COLLAPSE PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this   = $(this)
      var data    = $this.data('bs.collapse')
      var options = $.extend({}, Collapse.DEFAULTS, $this.data(), typeof option == 'object' && option)

      if (!data && options.toggle && /show|hide/.test(option)) options.toggle = false
      if (!data) $this.data('bs.collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  var old = $.fn.collapse

  $.fn.collapse             = Plugin
  $.fn.collapse.Constructor = Collapse


  // COLLAPSE NO CONFLICT
  // ====================

  $.fn.collapse.noConflict = function () {
    $.fn.collapse = old
    return this
  }


  // COLLAPSE DATA-API
  // =================

  $(document).on('click.bs.collapse.data-api', '[data-toggle="collapse"]', function (e) {
    var $this   = $(this)

    if (!$this.attr('data-target')) e.preventDefault()

    var $target = getTargetFromTrigger($this)
    var data    = $target.data('bs.collapse')
    var option  = data ? 'toggle' : $this.data()

    Plugin.call($target, option)
  })

}(jQuery);
</script>
<script>
window.initializeCodeFolding = function(show) {

  // handlers for show-all and hide all
  $("#rmd-show-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('show');
    });
  });
  $("#rmd-hide-all-code").click(function() {
    $('div.r-code-collapse').each(function() {
      $(this).collapse('hide');
    });
  });

  // index for unique code element ids
  var currentIndex = 1;

  // select all R code blocks
  var rCodeBlocks = $('pre.sourceCode, pre.r, pre.python, pre.bash, pre.sql, pre.cpp, pre.stan');
  rCodeBlocks.each(function() {

    // create a collapsable div to wrap the code in
    var div = $('<div class="collapse r-code-collapse"></div>');
    if (show)
      div.addClass('in');
    var id = 'rcode-643E0F36' + currentIndex++;
    div.attr('id', id);
    $(this).before(div);
    $(this).detach().appendTo(div);

    // add a show code button right above
    var showCodeText = $('<span>' + (show ? 'Hide' : 'Code') + '</span>');
    var showCodeButton = $('<button type="button" class="btn btn-default btn-xs code-folding-btn pull-right"></button>');
    showCodeButton.append(showCodeText);
    showCodeButton
        .attr('data-toggle', 'collapse')
        .attr('data-target', '#' + id)
        .attr('aria-expanded', show)
        .attr('aria-controls', id);

    var buttonRow = $('<div class="row"></div>');
    var buttonCol = $('<div class="col-md-12"></div>');

    buttonCol.append(showCodeButton);
    buttonRow.append(buttonCol);

    div.before(buttonRow);

    // update state of button on show/hide
    div.on('hidden.bs.collapse', function () {
      showCodeText.text('Code');
    });
    div.on('show.bs.collapse', function () {
      showCodeText.text('Hide');
    });
  });

}
</script>
<script>
/* ========================================================================
 * Bootstrap: dropdown.js v3.3.7
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2016 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */


+function ($) {
  'use strict';

  // DROPDOWN CLASS DEFINITION
  // =========================

  var backdrop = '.dropdown-backdrop'
  var toggle   = '[data-toggle="dropdown"]'
  var Dropdown = function (element) {
    $(element).on('click.bs.dropdown', this.toggle)
  }

  Dropdown.VERSION = '3.3.7'

  function getParent($this) {
    var selector = $this.attr('data-target')

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#[A-Za-z]/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') // strip for ie7
    }

    var $parent = selector && $(selector)

    return $parent && $parent.length ? $parent : $this.parent()
  }

  function clearMenus(e) {
    if (e && e.which === 3) return
    $(backdrop).remove()
    $(toggle).each(function () {
      var $this         = $(this)
      var $parent       = getParent($this)
      var relatedTarget = { relatedTarget: this }

      if (!$parent.hasClass('open')) return

      if (e && e.type == 'click' && /input|textarea/i.test(e.target.tagName) && $.contains($parent[0], e.target)) return

      $parent.trigger(e = $.Event('hide.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this.attr('aria-expanded', 'false')
      $parent.removeClass('open').trigger($.Event('hidden.bs.dropdown', relatedTarget))
    })
  }

  Dropdown.prototype.toggle = function (e) {
    var $this = $(this)

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    clearMenus()

    if (!isActive) {
      if ('ontouchstart' in document.documentElement && !$parent.closest('.navbar-nav').length) {
        // if mobile we use a backdrop because click events don't delegate
        $(document.createElement('div'))
          .addClass('dropdown-backdrop')
          .insertAfter($(this))
          .on('click', clearMenus)
      }

      var relatedTarget = { relatedTarget: this }
      $parent.trigger(e = $.Event('show.bs.dropdown', relatedTarget))

      if (e.isDefaultPrevented()) return

      $this
        .trigger('focus')
        .attr('aria-expanded', 'true')

      $parent
        .toggleClass('open')
        .trigger($.Event('shown.bs.dropdown', relatedTarget))
    }

    return false
  }

  Dropdown.prototype.keydown = function (e) {
    if (!/(38|40|27|32)/.test(e.which) || /input|textarea/i.test(e.target.tagName)) return

    var $this = $(this)

    e.preventDefault()
    e.stopPropagation()

    if ($this.is('.disabled, :disabled')) return

    var $parent  = getParent($this)
    var isActive = $parent.hasClass('open')

    if (!isActive && e.which != 27 || isActive && e.which == 27) {
      if (e.which == 27) $parent.find(toggle).trigger('focus')
      return $this.trigger('click')
    }

    var desc = ' li:not(.disabled):visible a'
    var $items = $parent.find('.dropdown-menu' + desc)

    if (!$items.length) return

    var index = $items.index(e.target)

    if (e.which == 38 && index > 0)                 index--         // up
    if (e.which == 40 && index < $items.length - 1) index++         // down
    if (!~index)                                    index = 0

    $items.eq(index).trigger('focus')
  }


  // DROPDOWN PLUGIN DEFINITION
  // ==========================

  function Plugin(option) {
    return this.each(function () {
      var $this = $(this)
      var data  = $this.data('bs.dropdown')

      if (!data) $this.data('bs.dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  var old = $.fn.dropdown

  $.fn.dropdown             = Plugin
  $.fn.dropdown.Constructor = Dropdown


  // DROPDOWN NO CONFLICT
  // ====================

  $.fn.dropdown.noConflict = function () {
    $.fn.dropdown = old
    return this
  }


  // APPLY TO STANDARD DROPDOWN ELEMENTS
  // ===================================

  $(document)
    .on('click.bs.dropdown.data-api', clearMenus)
    .on('click.bs.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
    .on('click.bs.dropdown.data-api', toggle, Dropdown.prototype.toggle)
    .on('keydown.bs.dropdown.data-api', toggle, Dropdown.prototype.keydown)
    .on('keydown.bs.dropdown.data-api', '.dropdown-menu', Dropdown.prototype.keydown)

}(jQuery);
</script>
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
.row { display: flex; }
.collapse { display: none; }
.in { display:block }
.pull-right > .dropdown-menu {
    right: 0;
    left: auto;
}
.open > .dropdown-menu {
    display: block;
}
.dropdown-menu {
    position: absolute;
    top: 100%;
    left: 0;
    z-index: 1000;
    display: none;
    float: left;
    min-width: 160px;
    padding: 5px 0;
    margin: 2px 0 0;
    font-size: 14px;
    text-align: left;
    list-style: none;
    background-color: #fff;
    -webkit-background-clip: padding-box;
    background-clip: padding-box;
    border: 1px solid #ccc;
    border: 1px solid rgba(0,0,0,.15);
    border-radius: 4px;
    -webkit-box-shadow: 0 6px 12px rgba(0,0,0,.175);
    box-shadow: 0 6px 12px rgba(0,0,0,.175);
}
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "hide");
});
</script>


<script>
document.write('<div class="btn-group pull-right" style="position: absolute; top: 20%; right: 2%; z-index: 200"><button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-_extension-text-contrast=""><span>Code</span> <span class="caret"></span></button><ul class="dropdown-menu" style="min-width: 50px;"><li><a id="rmd-show-all-code" href="#">Show All Code</a></li><li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li></ul></div>')
</script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">CRUK Functional Genomics Summer School 2020</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preamble</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#the-study"><i class="fa fa-check"></i><b>1.1</b> The study</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#the-plan"><i class="fa fa-check"></i><b>1.2</b> The plan</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#the-analyses"><i class="fa fa-check"></i><b>1.3</b> The analyses</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#overall-summary"><i class="fa fa-check"></i><b>1.4</b> Overall summary</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#conclusion"><i class="fa fa-check"></i><b>1.5</b> Conclusion</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#abbreviations"><i class="fa fa-check"></i><b>1.6</b> Abbreviations</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="SeqQualTop.html"><a href="SeqQualTop.html"><i class="fa fa-check"></i><b>2</b> Sequence Quality</a><ul>
<li class="chapter" data-level="2.1" data-path="SeqQualTop.html"><a href="SeqQualTop.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="SeqQualTop.html"><a href="SeqQualTop.html#caronbourque2020---fastqc"><i class="fa fa-check"></i><b>2.2</b> CaronBourque2020 - fastqc</a></li>
<li class="chapter" data-level="2.3" data-path="SeqQualTop.html"><a href="SeqQualTop.html#caronbourque2020---multiqc"><i class="fa fa-check"></i><b>2.3</b> CaronBourque2020 - MultiQC</a><ul>
<li class="chapter" data-level="2.3.1" data-path="SeqQualTop.html"><a href="SeqQualTop.html#sample-index-i1"><i class="fa fa-check"></i><b>2.3.1</b> sample index: I1</a></li>
<li class="chapter" data-level="2.3.2" data-path="SeqQualTop.html"><a href="SeqQualTop.html#cell-barcode-umi-r1"><i class="fa fa-check"></i><b>2.3.2</b> cell barcode + UMI: R1</a></li>
<li class="chapter" data-level="2.3.3" data-path="SeqQualTop.html"><a href="SeqQualTop.html#insert-r2"><i class="fa fa-check"></i><b>2.3.3</b> insert: R2</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="SeqQualTop.html"><a href="SeqQualTop.html#hca-adult-bmmc---fastqc"><i class="fa fa-check"></i><b>2.4</b> HCA adult BMMC - fastqc</a></li>
<li class="chapter" data-level="2.5" data-path="SeqQualTop.html"><a href="SeqQualTop.html#hca-adult-bmmc---multiqc"><i class="fa fa-check"></i><b>2.5</b> HCA adult BMMC - MultiQC</a><ul>
<li class="chapter" data-level="2.5.1" data-path="SeqQualTop.html"><a href="SeqQualTop.html#sample-index-i1-1"><i class="fa fa-check"></i><b>2.5.1</b> sample index: I1</a></li>
<li class="chapter" data-level="2.5.2" data-path="SeqQualTop.html"><a href="SeqQualTop.html#cell-barcode-umi-r1-1"><i class="fa fa-check"></i><b>2.5.2</b> cell barcode + UMI: R1</a></li>
<li class="chapter" data-level="2.5.3" data-path="SeqQualTop.html"><a href="SeqQualTop.html#insert-r2-1"><i class="fa fa-check"></i><b>2.5.3</b> insert: R2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="AliFeatCountTop.html"><a href="AliFeatCountTop.html"><i class="fa fa-check"></i><b>3</b> Alignment and feature counting</a><ul>
<li class="chapter" data-level="3.1" data-path="AliFeatCountTop.html"><a href="AliFeatCountTop.html#introduction-1"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="AliFeatCountTop.html"><a href="AliFeatCountTop.html#x-cellranger-pipeline-in-brief"><i class="fa fa-check"></i><b>3.2</b> 10X cellranger pipeline in brief</a></li>
<li class="chapter" data-level="3.3" data-path="AliFeatCountTop.html"><a href="AliFeatCountTop.html#sample-sheet"><i class="fa fa-check"></i><b>3.3</b> sample sheet</a></li>
<li class="chapter" data-level="3.4" data-path="AliFeatCountTop.html"><a href="AliFeatCountTop.html#x-cellranger-reports-for-caronbourque2020"><i class="fa fa-check"></i><b>3.4</b> 10X cellranger reports for CaronBourque2020</a></li>
<li class="chapter" data-level="3.5" data-path="AliFeatCountTop.html"><a href="AliFeatCountTop.html#x-cellranger-reports-for-hcas-adult-bmmcs"><i class="fa fa-check"></i><b>3.5</b> 10X cellranger reports for HCA’s adult BMMCs</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="QcTop.html"><a href="QcTop.html"><i class="fa fa-check"></i><b>4</b> Quality Control</a><ul>
<li class="chapter" data-level="4.1" data-path="QcTop.html"><a href="QcTop.html#introduction-2"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="QcTop.html"><a href="QcTop.html#load-packages"><i class="fa fa-check"></i><b>4.2</b> Load packages</a></li>
<li class="chapter" data-level="4.3" data-path="QcTop.html"><a href="QcTop.html#sample-sheet-1"><i class="fa fa-check"></i><b>4.3</b> Sample sheet</a></li>
<li class="chapter" data-level="4.4" data-path="QcTop.html"><a href="QcTop.html#data-representation"><i class="fa fa-check"></i><b>4.4</b> Data representation</a></li>
<li class="chapter" data-level="4.5" data-path="QcTop.html"><a href="QcTop.html#example"><i class="fa fa-check"></i><b>4.5</b> Example</a></li>
<li class="chapter" data-level="4.6" data-path="QcTop.html"><a href="QcTop.html#mapping-qc"><i class="fa fa-check"></i><b>4.6</b> Mapping QC</a><ul>
<li class="chapter" data-level="4.6.1" data-path="QcTop.html"><a href="QcTop.html#gene-body-coverage"><i class="fa fa-check"></i><b>4.6.1</b> Gene body coverage</a></li>
<li class="chapter" data-level="4.6.2" data-path="QcTop.html"><a href="QcTop.html#amplification-rate"><i class="fa fa-check"></i><b>4.6.2</b> Amplification rate</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="QcTop.html"><a href="QcTop.html#cell-calling-for-droplet-data"><i class="fa fa-check"></i><b>4.7</b> Cell calling for droplet data</a><ul>
<li class="chapter" data-level="4.7.1" data-path="QcTop.html"><a href="QcTop.html#mixture-model"><i class="fa fa-check"></i><b>4.7.1</b> Mixture model</a></li>
<li class="chapter" data-level="4.7.2" data-path="QcTop.html"><a href="QcTop.html#barcode-rank-plot"><i class="fa fa-check"></i><b>4.7.2</b> Barcode rank plot</a></li>
<li class="chapter" data-level="4.7.3" data-path="QcTop.html"><a href="QcTop.html#inflection-point"><i class="fa fa-check"></i><b>4.7.3</b> Inflection point</a></li>
<li class="chapter" data-level="4.7.4" data-path="QcTop.html"><a href="QcTop.html#cellranger-v1-and-v2"><i class="fa fa-check"></i><b>4.7.4</b> Cellranger v1 and v2</a></li>
<li class="chapter" data-level="4.7.5" data-path="QcTop.html"><a href="QcTop.html#dropletutils-and-emptydrops"><i class="fa fa-check"></i><b>4.7.5</b> DropletUtils and EmptyDrops</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="QcTop.html"><a href="QcTop.html#load-filtered-matrices"><i class="fa fa-check"></i><b>4.8</b> Load filtered matrices</a></li>
<li class="chapter" data-level="4.9" data-path="QcTop.html"><a href="QcTop.html#properties-of-scrna-seq-data"><i class="fa fa-check"></i><b>4.9</b> Properties of scRNA-seq data</a></li>
<li class="chapter" data-level="4.10" data-path="QcTop.html"><a href="QcTop.html#quality-control"><i class="fa fa-check"></i><b>4.10</b> Quality control</a><ul>
<li class="chapter" data-level="4.10.1" data-path="QcTop.html"><a href="QcTop.html#qc-metric-distribution"><i class="fa fa-check"></i><b>4.10.1</b> QC metric distribution</a></li>
</ul></li>
<li class="chapter" data-level="4.11" data-path="QcTop.html"><a href="QcTop.html#identification-of-low-quality-cells-with-adaptive-thresholds"><i class="fa fa-check"></i><b>4.11</b> Identification of low-quality cells with adaptive thresholds</a><ul>
<li class="chapter" data-level="4.11.1" data-path="QcTop.html"><a href="QcTop.html#library-size"><i class="fa fa-check"></i><b>4.11.1</b> Library size</a></li>
<li class="chapter" data-level="4.11.2" data-path="QcTop.html"><a href="QcTop.html#number-of-genes"><i class="fa fa-check"></i><b>4.11.2</b> Number of genes</a></li>
<li class="chapter" data-level="4.11.3" data-path="QcTop.html"><a href="QcTop.html#mitochondrial-content"><i class="fa fa-check"></i><b>4.11.3</b> Mitochondrial content</a></li>
<li class="chapter" data-level="4.11.4" data-path="QcTop.html"><a href="QcTop.html#summary"><i class="fa fa-check"></i><b>4.11.4</b> Summary</a></li>
<li class="chapter" data-level="4.11.5" data-path="QcTop.html"><a href="QcTop.html#all-steps-at-once"><i class="fa fa-check"></i><b>4.11.5</b> All steps at once</a></li>
<li class="chapter" data-level="4.11.6" data-path="QcTop.html"><a href="QcTop.html#assumptions"><i class="fa fa-check"></i><b>4.11.6</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="4.12" data-path="QcTop.html"><a href="QcTop.html#experimental-factors"><i class="fa fa-check"></i><b>4.12</b> Experimental factors</a><ul>
<li class="chapter" data-level="4.12.1" data-path="QcTop.html"><a href="QcTop.html#identify-poor-quality-batches"><i class="fa fa-check"></i><b>4.12.1</b> Identify poor-quality batches</a><ul>
<li class="chapter" data-level="4.12.1.1" data-path="QcTop.html"><a href="QcTop.html#number-of-genes-detected"><i class="fa fa-check"></i><b>4.12.1.1</b> Number of genes detected</a><ul>
<li class="chapter" data-level="4.12.1.1.1" data-path="QcTop.html"><a href="QcTop.html#mitochondrial-content-1"><i class="fa fa-check"></i><b>4.12.1.1.1</b> Mitochondrial content</a></li>
</ul></li>
<li class="chapter" data-level="4.12.1.2" data-path="QcTop.html"><a href="QcTop.html#samples-to-check"><i class="fa fa-check"></i><b>4.12.1.2</b> Samples to check</a></li>
</ul></li>
<li class="chapter" data-level="4.12.2" data-path="QcTop.html"><a href="QcTop.html#qc-metrics-space"><i class="fa fa-check"></i><b>4.12.2</b> QC metrics space</a></li>
<li class="chapter" data-level="4.12.3" data-path="QcTop.html"><a href="QcTop.html#qc-pca"><i class="fa fa-check"></i><b>4.12.3</b> QC PCA</a></li>
<li class="chapter" data-level="4.12.4" data-path="QcTop.html"><a href="QcTop.html#other-diagnostic-plots"><i class="fa fa-check"></i><b>4.12.4</b> Other diagnostic plots</a></li>
<li class="chapter" data-level="4.12.5" data-path="QcTop.html"><a href="QcTop.html#filter-low-quality-cells-out"><i class="fa fa-check"></i><b>4.12.5</b> Filter low-quality cells out</a></li>
</ul></li>
<li class="chapter" data-level="4.13" data-path="QcTop.html"><a href="QcTop.html#novelty"><i class="fa fa-check"></i><b>4.13</b> Novelty</a></li>
<li class="chapter" data-level="4.14" data-path="QcTop.html"><a href="QcTop.html#qc-based-on-sparsity"><i class="fa fa-check"></i><b>4.14</b> QC based on sparsity</a><ul>
<li class="chapter" data-level="4.14.1" data-path="QcTop.html"><a href="QcTop.html#remove-genes-that-are-not-expressed-at-all"><i class="fa fa-check"></i><b>4.14.1</b> Remove genes that are not expressed at all</a></li>
<li class="chapter" data-level="4.14.2" data-path="QcTop.html"><a href="QcTop.html#sparsity-plots"><i class="fa fa-check"></i><b>4.14.2</b> Sparsity plots</a></li>
<li class="chapter" data-level="4.14.3" data-path="QcTop.html"><a href="QcTop.html#filters"><i class="fa fa-check"></i><b>4.14.3</b> Filters</a></li>
<li class="chapter" data-level="4.14.4" data-path="QcTop.html"><a href="QcTop.html#separate-caron-and-hca-batches"><i class="fa fa-check"></i><b>4.14.4</b> Separate Caron and Hca batches</a></li>
<li class="chapter" data-level="4.14.5" data-path="QcTop.html"><a href="QcTop.html#caron-only"><i class="fa fa-check"></i><b>4.14.5</b> Caron only</a></li>
<li class="chapter" data-level="4.14.6" data-path="QcTop.html"><a href="QcTop.html#hca-only"><i class="fa fa-check"></i><b>4.14.6</b> Hca only</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html"><i class="fa fa-check"></i><b>5</b> Normalisation - GSM3872434 set</a><ul>
<li class="chapter" data-level="5.1" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#scaling-normalization"><i class="fa fa-check"></i><b>5.1</b> Scaling normalization</a><ul>
<li class="chapter" data-level="5.1.1" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#cpm"><i class="fa fa-check"></i><b>5.1.1</b> CPM</a></li>
<li class="chapter" data-level="5.1.2" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#deseqs-size-factor"><i class="fa fa-check"></i><b>5.1.2</b> DESeq’s size factor</a></li>
<li class="chapter" data-level="5.1.3" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#weighted-trimmed-mean-of-m-values"><i class="fa fa-check"></i><b>5.1.3</b> Weighted Trimmed mean of M-values</a></li>
<li class="chapter" data-level="5.1.4" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#library-size-factor-distribution"><i class="fa fa-check"></i><b>5.1.4</b> Library size factor distribution</a></li>
<li class="chapter" data-level="5.1.5" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#deconvolution"><i class="fa fa-check"></i><b>5.1.5</b> Deconvolution</a><ul>
<li class="chapter" data-level="5.1.5.1" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#cluster-cells"><i class="fa fa-check"></i><b>5.1.5.1</b> Cluster cells</a></li>
<li class="chapter" data-level="5.1.5.2" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#compute-size-factors"><i class="fa fa-check"></i><b>5.1.5.2</b> Compute size factors</a></li>
<li class="chapter" data-level="5.1.5.3" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#apply-size-factors"><i class="fa fa-check"></i><b>5.1.5.3</b> Apply size factors</a></li>
<li class="chapter" data-level="5.1.5.4" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#save-object"><i class="fa fa-check"></i><b>5.1.5.4</b> Save object</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#sctransform"><i class="fa fa-check"></i><b>5.2</b> sctransform</a><ul>
<li class="chapter" data-level="5.2.1" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#inspect-data"><i class="fa fa-check"></i><b>5.2.1</b> Inspect data</a></li>
<li class="chapter" data-level="5.2.2" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#transformation"><i class="fa fa-check"></i><b>5.2.2</b> Transformation</a></li>
<li class="chapter" data-level="5.2.3" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#save-sce-object"><i class="fa fa-check"></i><b>5.2.3</b> Save SCE object</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#visualisation"><i class="fa fa-check"></i><b>5.3</b> Visualisation</a><ul>
<li class="chapter" data-level="5.3.1" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#log-raw-counts"><i class="fa fa-check"></i><b>5.3.1</b> log raw counts</a></li>
<li class="chapter" data-level="5.3.2" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#log-cpm"><i class="fa fa-check"></i><b>5.3.2</b> log CPM</a></li>
<li class="chapter" data-level="5.3.3" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#scran"><i class="fa fa-check"></i><b>5.3.3</b> scran</a></li>
<li class="chapter" data-level="5.3.4" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#sctransform-1"><i class="fa fa-check"></i><b>5.3.4</b> SCTransform</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="normalisation-gsm3872434-set.html"><a href="normalisation-gsm3872434-set.html#session-information"><i class="fa fa-check"></i><b>5.4</b> Session information</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html"><i class="fa fa-check"></i><b>6</b> Dimensionality reduction for visualisation</a><ul>
<li class="chapter" data-level="6.1" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#principal-component-analysis"><i class="fa fa-check"></i><b>6.1</b> Principal Component Analysis</a><ul>
<li class="chapter" data-level="6.1.1" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#description"><i class="fa fa-check"></i><b>6.1.1</b> Description</a></li>
<li class="chapter" data-level="6.1.2" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#example-1"><i class="fa fa-check"></i><b>6.1.2</b> Example</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#load-packages-1"><i class="fa fa-check"></i><b>6.2</b> Load packages</a></li>
<li class="chapter" data-level="6.3" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#load-data"><i class="fa fa-check"></i><b>6.3</b> Load data</a></li>
<li class="chapter" data-level="6.4" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#pca"><i class="fa fa-check"></i><b>6.4</b> PCA</a><ul>
<li class="chapter" data-level="6.4.1" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#correlation-between-pcs-and-the-total-number-of-features-detected"><i class="fa fa-check"></i><b>6.4.1</b> Correlation between PCs and the total number of features detected</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#t-sne-t-distributed-stochastic-neighbor-embedding"><i class="fa fa-check"></i><b>6.5</b> t-SNE: t-Distributed Stochastic Neighbor Embedding</a><ul>
<li class="chapter" data-level="6.5.1" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#perplexity"><i class="fa fa-check"></i><b>6.5.1</b> Perplexity</a></li>
<li class="chapter" data-level="6.5.2" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#stochasticity"><i class="fa fa-check"></i><b>6.5.2</b> Stochasticity</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="dimensionality-reduction-for-visualisation.html"><a href="dimensionality-reduction-for-visualisation.html#umap"><i class="fa fa-check"></i><b>6.6</b> UMAP</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="feature-selection.html"><a href="feature-selection.html"><i class="fa fa-check"></i><b>7</b> Feature selection</a><ul>
<li class="chapter" data-level="7.1" data-path="feature-selection.html"><a href="feature-selection.html#load-data-1"><i class="fa fa-check"></i><b>7.1</b> Load data</a></li>
<li class="chapter" data-level="7.2" data-path="feature-selection.html"><a href="feature-selection.html#feature-selection-with-scran"><i class="fa fa-check"></i><b>7.2</b> Feature selection with scran</a><ul>
<li class="chapter" data-level="7.2.1" data-path="feature-selection.html"><a href="feature-selection.html#modelling-and-removing-technical-noise"><i class="fa fa-check"></i><b>7.2.1</b> Modelling and removing technical noise</a></li>
<li class="chapter" data-level="7.2.2" data-path="feature-selection.html"><a href="feature-selection.html#choosing-some-hvgs"><i class="fa fa-check"></i><b>7.2.2</b> Choosing some HVGs:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html"><i class="fa fa-check"></i><b>8</b> batch correction - GSM3872442 set</a><ul>
<li class="chapter" data-level="8.1" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#prepare-data"><i class="fa fa-check"></i><b>8.1</b> Prepare data</a></li>
<li class="chapter" data-level="8.2" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#normalise-each-separately-and-re-pool"><i class="fa fa-check"></i><b>8.2</b> Normalise each separately and re-pool</a></li>
<li class="chapter" data-level="8.3" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#normalise-batches-together"><i class="fa fa-check"></i><b>8.3</b> Normalise batches together</a></li>
<li class="chapter" data-level="8.4" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#batch-correction"><i class="fa fa-check"></i><b>8.4</b> Batch correction</a><ul>
<li class="chapter" data-level="8.4.1" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#gaussian-normal-linear-models"><i class="fa fa-check"></i><b>8.4.1</b> Gaussian (normal) linear models</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#sctransform-2"><i class="fa fa-check"></i><b>8.5</b> SCTransform</a><ul>
<li class="chapter" data-level="8.5.1" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#batch-only"><i class="fa fa-check"></i><b>8.5.1</b> Batch only</a></li>
<li class="chapter" data-level="8.5.2" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#both-library-size-and-batch"><i class="fa fa-check"></i><b>8.5.2</b> Both library size and batch</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#mnncorrect"><i class="fa fa-check"></i><b>8.6</b> mnnCorrect</a><ul>
<li class="chapter" data-level="8.6.1" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#check-presence-of-batch-effect"><i class="fa fa-check"></i><b>8.6.1</b> Check presence of batch effect</a></li>
<li class="chapter" data-level="8.6.2" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#correct-batch-effect-with-mnncorrect"><i class="fa fa-check"></i><b>8.6.2</b> Correct batch effect with mnnCorrect</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#fastmnn"><i class="fa fa-check"></i><b>8.7</b> fastMNN</a></li>
<li class="chapter" data-level="8.8" data-path="batch-correction-gsm3872442-set.html"><a href="batch-correction-gsm3872442-set.html#harmony"><i class="fa fa-check"></i><b>8.8</b> Harmony</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="dimensionality-reduction-for-analysis.html"><a href="dimensionality-reduction-for-analysis.html"><i class="fa fa-check"></i><b>9</b> Dimensionality reduction for analysis</a><ul>
<li class="chapter" data-level="9.1" data-path="dimensionality-reduction-for-analysis.html"><a href="dimensionality-reduction-for-analysis.html#load-data-2"><i class="fa fa-check"></i><b>9.1</b> Load data</a></li>
<li class="chapter" data-level="9.2" data-path="dimensionality-reduction-for-analysis.html"><a href="dimensionality-reduction-for-analysis.html#denoising-expression-values-using-pca"><i class="fa fa-check"></i><b>9.2</b> Denoising expression values using PCA</a></li>
<li class="chapter" data-level="9.3" data-path="dimensionality-reduction-for-analysis.html"><a href="dimensionality-reduction-for-analysis.html#visualise-expression-patterns-of-some-hvgs"><i class="fa fa-check"></i><b>9.3</b> Visualise expression patterns of some HVGs</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">CRUK Bioinformatics Summer School 2020 - single-cell RNA-seq analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dimensionality-reduction-for-analysis" class="section level1">
<h1><span class="header-section-number">Chapter 9</span> Dimensionality reduction for analysis</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="dimensionality-reduction-for-analysis.html#cb1-1"></a>projDir &lt;-<span class="st"> </span>params<span class="op">$</span>projDir</span>
<span id="cb1-2"><a href="dimensionality-reduction-for-analysis.html#cb1-2"></a>dirRel &lt;-<span class="st"> </span>params<span class="op">$</span>dirRel</span>
<span id="cb1-3"><a href="dimensionality-reduction-for-analysis.html#cb1-3"></a>outDirBit &lt;-<span class="st"> </span>params<span class="op">$</span>outDirBit</span>
<span id="cb1-4"><a href="dimensionality-reduction-for-analysis.html#cb1-4"></a>cacheBool &lt;-<span class="st"> </span>params<span class="op">$</span>cacheBool</span>
<span id="cb1-5"><a href="dimensionality-reduction-for-analysis.html#cb1-5"></a>nbPcToComp &lt;-<span class="st"> </span><span class="dv">50</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="dimensionality-reduction-for-analysis.html#cb2-1"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(ggplot2))</span>
<span id="cb2-2"><a href="dimensionality-reduction-for-analysis.html#cb2-2"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(scater))</span>
<span id="cb2-3"><a href="dimensionality-reduction-for-analysis.html#cb2-3"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(scran))</span>
<span id="cb2-4"><a href="dimensionality-reduction-for-analysis.html#cb2-4"></a><span class="kw">suppressMessages</span>(<span class="kw">library</span>(dplyr))</span>
<span id="cb2-5"><a href="dimensionality-reduction-for-analysis.html#cb2-5"></a>fontsize &lt;-<span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>), <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">16</span>))</span></code></pre></div>
<div id="load-data-2" class="section level2">
<h2><span class="header-section-number">9.1</span> Load data</h2>
<p>We will load the R file keeping the SCE object with the normalised counts for 500 cells per sample.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="dimensionality-reduction-for-analysis.html#cb3-1"></a>setName &lt;-<span class="st"> &quot;caron&quot;</span></span>
<span id="cb3-2"><a href="dimensionality-reduction-for-analysis.html#cb3-2"></a>setSuf &lt;-<span class="st"> &quot;_5hCellPerSpl&quot;</span></span>
<span id="cb3-3"><a href="dimensionality-reduction-for-analysis.html#cb3-3"></a></span>
<span id="cb3-4"><a href="dimensionality-reduction-for-analysis.html#cb3-4"></a><span class="co"># Read object in:</span></span>
<span id="cb3-5"><a href="dimensionality-reduction-for-analysis.html#cb3-5"></a>tmpFn &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/%s/Robjects/%s_sce_nz_postDeconv%s_dimRed.Rds&quot;</span>, projDir, outDirBit, setName, setSuf)</span>
<span id="cb3-6"><a href="dimensionality-reduction-for-analysis.html#cb3-6"></a><span class="kw">print</span>(tmpFn)</span></code></pre></div>
<pre><code>## [1] &quot;/ssd/personal/baller01/20200511_FernandesM_ME_crukBiSs2020/AnaWiSce/Ana1/Robjects/caron_sce_nz_postDeconv_5hCellPerSpl_dimRed.Rds&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="dimensionality-reduction-for-analysis.html#cb5-1"></a><span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(tmpFn))</span>
<span id="cb5-2"><a href="dimensionality-reduction-for-analysis.html#cb5-2"></a>{</span>
<span id="cb5-3"><a href="dimensionality-reduction-for-analysis.html#cb5-3"></a>    knitr<span class="op">::</span><span class="kw">knit_exit</span>()</span>
<span id="cb5-4"><a href="dimensionality-reduction-for-analysis.html#cb5-4"></a>}</span>
<span id="cb5-5"><a href="dimensionality-reduction-for-analysis.html#cb5-5"></a>sce &lt;-<span class="st"> </span><span class="kw">readRDS</span>(tmpFn)</span>
<span id="cb5-6"><a href="dimensionality-reduction-for-analysis.html#cb5-6"></a>sce</span></code></pre></div>
<pre><code>## class: SingleCellExperiment 
## dim: 16629 5500 
## metadata(0):
## assays(2): counts logcounts
## rownames(16629): ENSG00000237491 ENSG00000225880 ... ENSG00000275063
##   ENSG00000271254
## rowData names(11): ensembl_gene_id external_gene_name ... detected
##   gene_sparsity
## colnames: NULL
## colData names(16): Barcode Run ... cell_sparsity sizeFactor
## reducedDimNames(3): PCA TSNE UMAP
## altExpNames(0):</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="dimensionality-reduction-for-analysis.html#cb7-1"></a><span class="co">#any(duplicated(rowData(sce)$ensembl_gene_id))</span></span>
<span id="cb7-2"><a href="dimensionality-reduction-for-analysis.html#cb7-2"></a><span class="co"># some function(s) used below complain about &#39;strand&#39; already being used in row data,</span></span>
<span id="cb7-3"><a href="dimensionality-reduction-for-analysis.html#cb7-3"></a><span class="co"># so rename that column now:</span></span>
<span id="cb7-4"><a href="dimensionality-reduction-for-analysis.html#cb7-4"></a><span class="kw">colnames</span>(<span class="kw">rowData</span>(sce))[<span class="kw">colnames</span>(<span class="kw">rowData</span>(sce)) <span class="op">==</span><span class="st"> &quot;strand&quot;</span>] &lt;-<span class="st"> &quot;strandNum&quot;</span></span>
<span id="cb7-5"><a href="dimensionality-reduction-for-analysis.html#cb7-5"></a></span>
<span id="cb7-6"><a href="dimensionality-reduction-for-analysis.html#cb7-6"></a><span class="co"># also get feature selection outcome</span></span>
<span id="cb7-7"><a href="dimensionality-reduction-for-analysis.html#cb7-7"></a>tmpFn &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/%s/Robjects/%s_sce_nz_postDeconv%s_featSel.Rds&quot;</span>, projDir, outDirBit, setName, setSuf)</span>
<span id="cb7-8"><a href="dimensionality-reduction-for-analysis.html#cb7-8"></a>tmpList &lt;-<span class="st"> </span><span class="kw">readRDS</span>(tmpFn)</span>
<span id="cb7-9"><a href="dimensionality-reduction-for-analysis.html#cb7-9"></a>dec.sce &lt;-<span class="st"> </span>tmpList<span class="op">$</span>dec.sce</span>
<span id="cb7-10"><a href="dimensionality-reduction-for-analysis.html#cb7-10"></a>hvg.index &lt;-<span class="st"> </span>tmpList<span class="op">$</span>hvg.index</span></code></pre></div>
</div>
<div id="denoising-expression-values-using-pca" class="section level2">
<h2><span class="header-section-number">9.2</span> Denoising expression values using PCA</h2>
<p>Aim: use the trend fitted above to identify PCs linked to biology.</p>
<p>Assumption: biology drives most of the variance hence should be captured by the first PCs, while technical noise affects each gene independently, hence is captured by later PCs.</p>
<p>Logic: Compute the sum of the technical component across genes used in the PCA, use it as the amount of variance not related to biology and that we should therefore remove. Later PCs are excluded until the amount of variance they account for matches that corresponding to the technical component.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="dimensionality-reduction-for-analysis.html#cb8-1"></a>var.fit &lt;-<span class="st"> </span><span class="kw">metadata</span>(dec.sce)</span>
<span id="cb8-2"><a href="dimensionality-reduction-for-analysis.html#cb8-2"></a></span>
<span id="cb8-3"><a href="dimensionality-reduction-for-analysis.html#cb8-3"></a><span class="co"># remove uninteresting PCs:</span></span>
<span id="cb8-4"><a href="dimensionality-reduction-for-analysis.html#cb8-4"></a><span class="co">#options(BiocSingularParam.default=IrlbaParam())</span></span>
<span id="cb8-5"><a href="dimensionality-reduction-for-analysis.html#cb8-5"></a>sce &lt;-<span class="st"> </span><span class="kw">denoisePCA</span>(sce, <span class="dt">technical=</span>var.fit<span class="op">$</span>trend, <span class="dt">assay.type=</span><span class="st">&quot;logcounts&quot;</span>)</span>
<span id="cb8-6"><a href="dimensionality-reduction-for-analysis.html#cb8-6"></a><span class="co"># check assay names, should see &#39;PCA&#39;:</span></span>
<span id="cb8-7"><a href="dimensionality-reduction-for-analysis.html#cb8-7"></a><span class="co">##assayNames(sce)</span></span>
<span id="cb8-8"><a href="dimensionality-reduction-for-analysis.html#cb8-8"></a><span class="co"># check dimension of the PC table:</span></span>
<span id="cb8-9"><a href="dimensionality-reduction-for-analysis.html#cb8-9"></a><span class="co">##dim(reducedDim(sce, &quot;PCA&quot;)) </span></span>
<span id="cb8-10"><a href="dimensionality-reduction-for-analysis.html#cb8-10"></a></span>
<span id="cb8-11"><a href="dimensionality-reduction-for-analysis.html#cb8-11"></a>sce.pca &lt;-<span class="st"> </span><span class="kw">reducedDim</span>(sce, <span class="st">&quot;PCA&quot;</span>) <span class="co"># get copy of PCA matrix</span></span>
<span id="cb8-12"><a href="dimensionality-reduction-for-analysis.html#cb8-12"></a>tmpCol &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;grey&quot;</span>, nbPcToComp) <span class="co"># set colours to show selected PCs in green</span></span>
<span id="cb8-13"><a href="dimensionality-reduction-for-analysis.html#cb8-13"></a>tmpCol[<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(sce.pca)[<span class="dv">2</span>]] &lt;-<span class="st"> &quot;green&quot;</span></span>
<span id="cb8-14"><a href="dimensionality-reduction-for-analysis.html#cb8-14"></a><span class="kw">barplot</span>(<span class="kw">attributes</span>(sce.pca)<span class="op">$</span>percentVar[<span class="dv">1</span><span class="op">:</span>nbPcToComp],</span>
<span id="cb8-15"><a href="dimensionality-reduction-for-analysis.html#cb8-15"></a>        <span class="dt">main=</span><span class="kw">sprintf</span>(<span class="st">&quot;Scree plot for the %s first PCs&quot;</span>, nbPcToComp),</span>
<span id="cb8-16"><a href="dimensionality-reduction-for-analysis.html#cb8-16"></a>        <span class="dt">names.arg=</span><span class="dv">1</span><span class="op">:</span>nbPcToComp,</span>
<span id="cb8-17"><a href="dimensionality-reduction-for-analysis.html#cb8-17"></a>        <span class="dt">col=</span>tmpCol,</span>
<span id="cb8-18"><a href="dimensionality-reduction-for-analysis.html#cb8-18"></a>        <span class="dt">cex.names =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/comp_denoisePCA-1.png" width="672" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="dimensionality-reduction-for-analysis.html#cb9-1"></a><span class="co"># cumulative proportion of variance explained by selected PCs</span></span>
<span id="cb9-2"><a href="dimensionality-reduction-for-analysis.html#cb9-2"></a><span class="kw">cumsum</span>(<span class="kw">attributes</span>(sce.pca)<span class="op">$</span>percentVar)[<span class="dv">1</span><span class="op">:</span><span class="kw">dim</span>(sce.pca)[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>## [1]  8.896404 13.377510 15.836450 17.776817 19.275430 20.373215 21.359134</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="dimensionality-reduction-for-analysis.html#cb11-1"></a><span class="co"># plot on PC1 and PC2 plane:</span></span>
<span id="cb11-2"><a href="dimensionality-reduction-for-analysis.html#cb11-2"></a><span class="kw">plotPCA</span>(sce, <span class="dt">colour_by =</span> <span class="st">&quot;Sample.Name&quot;</span>)</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/comp_denoisePCA-2.png" width="672" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="dimensionality-reduction-for-analysis.html#cb12-1"></a><span class="co">#require(knitr); knit_exit()</span></span>
<span id="cb12-2"><a href="dimensionality-reduction-for-analysis.html#cb12-2"></a><span class="kw">rm</span>(tmpCol)</span></code></pre></div>
<p>Show cells on plane for PC1 and PC2:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="dimensionality-reduction-for-analysis.html#cb13-1"></a><span class="kw">plotReducedDim</span>(sce, <span class="dt">dimred =</span> <span class="st">&quot;PCA&quot;</span>, <span class="dt">ncomponents =</span> <span class="dv">3</span>, </span>
<span id="cb13-2"><a href="dimensionality-reduction-for-analysis.html#cb13-2"></a>        <span class="dt">colour_by =</span> <span class="st">&quot;Sample.Name&quot;</span>) <span class="op">+</span><span class="st"> </span>fontsize</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_denoisePCA-1.png" width="672" /></p>
</div>
<div id="visualise-expression-patterns-of-some-hvgs" class="section level2">
<h2><span class="header-section-number">9.3</span> Visualise expression patterns of some HVGs</h2>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="dimensionality-reduction-for-analysis.html#cb14-1"></a>o &lt;-<span class="st"> </span><span class="kw">order</span>(dec.sce<span class="op">$</span>bio, <span class="dt">decreasing=</span><span class="ot">TRUE</span>)</span>
<span id="cb14-2"><a href="dimensionality-reduction-for-analysis.html#cb14-2"></a>chosen.genes.index &lt;-<span class="st"> </span>o[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>]</span>
<span id="cb14-3"><a href="dimensionality-reduction-for-analysis.html#cb14-3"></a>dec.sce <span class="op">%&gt;%</span></span>
<span id="cb14-4"><a href="dimensionality-reduction-for-analysis.html#cb14-4"></a><span class="st">    </span><span class="kw">data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb14-5"><a href="dimensionality-reduction-for-analysis.html#cb14-5"></a><span class="st">    </span>tibble<span class="op">::</span><span class="kw">rownames_to_column</span>(<span class="st">&quot;ensembl_gene_id&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-6"><a href="dimensionality-reduction-for-analysis.html#cb14-6"></a><span class="st">    </span><span class="kw">right_join</span>(<span class="kw">data.frame</span>(<span class="kw">rowData</span>(sce)[chosen.genes.index,]), <span class="dt">by=</span><span class="st">&quot;ensembl_gene_id&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb14-7"><a href="dimensionality-reduction-for-analysis.html#cb14-7"></a><span class="st">    </span><span class="kw">select</span>(ensembl_gene_id, Symbol, bio, FDR) <span class="op">%&gt;%</span></span>
<span id="cb14-8"><a href="dimensionality-reduction-for-analysis.html#cb14-8"></a><span class="st">    </span><span class="kw">arrange</span>(<span class="op">-</span>bio)</span></code></pre></div>
<pre><code>##    ensembl_gene_id   Symbol       bio           FDR
## 1  ENSG00000244734      HBB 9.9171769  0.000000e+00
## 2  ENSG00000188536     HBA2 7.7794041 2.972588e-294
## 3  ENSG00000206172     HBA1 7.0043193 4.779957e-274
## 4  ENSG00000223609      HBD 3.3957008 4.577032e-172
## 5  ENSG00000019582     CD74 2.8618016  3.094419e-36
## 6  ENSG00000206177      HBM 2.4892938 8.578895e-158
## 7  ENSG00000169877     AHSP 2.3900935 2.484397e-139
## 8  ENSG00000204287  HLA-DRA 2.1588296  3.595363e-19
## 9  ENSG00000133742      CA1 1.8438387 2.361697e-106
## 10 ENSG00000147454 SLC25A37 1.4096101  7.293043e-51
## 11 ENSG00000100721    TCL1A 1.4000817  1.136107e-11
## 12 ENSG00000158578    ALAS2 1.3752702  4.585267e-98
## 13 ENSG00000165949    IFI27 1.3235939 3.388134e-107
## 14 ENSG00000090013    BLVRB 1.2749324  1.094525e-59
## 15 ENSG00000170345      FOS 1.2229340  1.435911e-06
## 16 ENSG00000211592     IGKC 1.1380972  1.871733e-25
## 17 ENSG00000090382      LYZ 1.0826247  6.153236e-81
## 18 ENSG00000170180     GYPA 1.0476546  7.220887e-79
## 19 ENSG00000143546   S100A8 0.9895714  1.802247e-73
## 20 ENSG00000171223     JUNB 0.9795045  4.161608e-08</code></pre>
<p>On PCA plot:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="dimensionality-reduction-for-analysis.html#cb16-1"></a><span class="co"># make and store PCA plot for top HVG 1:</span></span>
<span id="cb16-2"><a href="dimensionality-reduction-for-analysis.html#cb16-2"></a>pca1 &lt;-<span class="st"> </span><span class="kw">plotReducedDim</span>(sce, <span class="dt">dimred=</span><span class="st">&quot;PCA&quot;</span>, <span class="dt">colour_by=</span><span class="kw">rowData</span>(sce)[chosen.genes.index[<span class="dv">1</span>],<span class="st">&quot;ensembl_gene_id&quot;</span>]) <span class="op">+</span><span class="st"> </span>fontsize  <span class="co"># + coord_fixed()</span></span>
<span id="cb16-3"><a href="dimensionality-reduction-for-analysis.html#cb16-3"></a><span class="co"># make and store PCA plot for top HVG 2:</span></span>
<span id="cb16-4"><a href="dimensionality-reduction-for-analysis.html#cb16-4"></a>pca2 &lt;-<span class="st"> </span><span class="kw">plotReducedDim</span>(sce, <span class="dt">dimred=</span><span class="st">&quot;PCA&quot;</span>, <span class="dt">colour_by=</span><span class="kw">rowData</span>(sce)[chosen.genes.index[<span class="dv">2</span>],<span class="st">&quot;ensembl_gene_id&quot;</span>]) <span class="op">+</span><span class="st"> </span>fontsize <span class="co"># + coord_fixed()</span></span>
<span id="cb16-5"><a href="dimensionality-reduction-for-analysis.html#cb16-5"></a></span>
<span id="cb16-6"><a href="dimensionality-reduction-for-analysis.html#cb16-6"></a>pca1</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_pca_HVGtop2-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="dimensionality-reduction-for-analysis.html#cb17-1"></a>pca2</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_pca_HVGtop2-2.png" width="672" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="dimensionality-reduction-for-analysis.html#cb18-1"></a><span class="co"># display plots next to each other:</span></span>
<span id="cb18-2"><a href="dimensionality-reduction-for-analysis.html#cb18-2"></a><span class="co"># multiplot(pca1, pca2, cols=2)</span></span>
<span id="cb18-3"><a href="dimensionality-reduction-for-analysis.html#cb18-3"></a></span>
<span id="cb18-4"><a href="dimensionality-reduction-for-analysis.html#cb18-4"></a>pca1 <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>sce<span class="op">$</span>source_name) <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>()</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_pca_HVGtop2_facet-1.png" width="1152" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="dimensionality-reduction-for-analysis.html#cb19-1"></a>pca2 <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>sce<span class="op">$</span>source_name) <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>()</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_pca_HVGtop2_facet-2.png" width="1152" /></p>
<p>On t-SNE plot:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="dimensionality-reduction-for-analysis.html#cb20-1"></a><span class="co"># plot TSNE, accessing counts for the gene of interest with the ID used to name rows in the count matrix:</span></span>
<span id="cb20-2"><a href="dimensionality-reduction-for-analysis.html#cb20-2"></a><span class="co"># make and store TSNE plot for top HVG 1:</span></span>
<span id="cb20-3"><a href="dimensionality-reduction-for-analysis.html#cb20-3"></a>tsne1 &lt;-<span class="st"> </span><span class="kw">plotTSNE</span>(sce, <span class="dt">colour_by=</span><span class="kw">rowData</span>(sce)[chosen.genes.index[<span class="dv">1</span>],<span class="st">&quot;ensembl_gene_id&quot;</span>]) <span class="op">+</span><span class="st"> </span>fontsize</span>
<span id="cb20-4"><a href="dimensionality-reduction-for-analysis.html#cb20-4"></a><span class="co"># make and store TSNE plot for top HVG 2:</span></span>
<span id="cb20-5"><a href="dimensionality-reduction-for-analysis.html#cb20-5"></a>tsne2 &lt;-<span class="st"> </span><span class="kw">plotTSNE</span>(sce, <span class="dt">colour_by=</span><span class="kw">rowData</span>(sce)[chosen.genes.index[<span class="dv">2</span>],<span class="st">&quot;ensembl_gene_id&quot;</span>]) <span class="op">+</span><span class="st"> </span>fontsize</span>
<span id="cb20-6"><a href="dimensionality-reduction-for-analysis.html#cb20-6"></a></span>
<span id="cb20-7"><a href="dimensionality-reduction-for-analysis.html#cb20-7"></a>tsne1</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_tsne_HVGtop2-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="dimensionality-reduction-for-analysis.html#cb21-1"></a>tsne2</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_tsne_HVGtop2-2.png" width="672" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="dimensionality-reduction-for-analysis.html#cb22-1"></a><span class="co"># display plots next to each other:</span></span>
<span id="cb22-2"><a href="dimensionality-reduction-for-analysis.html#cb22-2"></a><span class="co">#multiplot(tsne1, tsne2, cols=2)</span></span>
<span id="cb22-3"><a href="dimensionality-reduction-for-analysis.html#cb22-3"></a></span>
<span id="cb22-4"><a href="dimensionality-reduction-for-analysis.html#cb22-4"></a>tsne1 <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>sce<span class="op">$</span>source_name)</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_tsne_HVGtop2_facet-1.png" width="1152" /></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="dimensionality-reduction-for-analysis.html#cb23-1"></a>tsne2 <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>sce<span class="op">$</span>source_name)</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/plot_count_tsne_HVGtop2_facet-2.png" width="1152" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="dimensionality-reduction-for-analysis.html#cb24-1"></a><span class="co"># display plots next to each other, splitting each by sample:</span></span>
<span id="cb24-2"><a href="dimensionality-reduction-for-analysis.html#cb24-2"></a><span class="co">#multiplot(tsne1 + facet_grid(. ~ sce$Sample2), tsne2 + facet_grid(. ~ sce$Sample2), cols=2)</span></span></code></pre></div>
<p>Write R object to file</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="dimensionality-reduction-for-analysis.html#cb25-1"></a>tmpFn &lt;-<span class="st"> </span><span class="kw">sprintf</span>(<span class="st">&quot;%s/%s/Robjects/%s_sce_nz_postDeconv%s_denoised.Rds&quot;</span>, projDir, outDirBit, setName, setSuf)</span>
<span id="cb25-2"><a href="dimensionality-reduction-for-analysis.html#cb25-2"></a><span class="kw">print</span>(tmpFn)</span></code></pre></div>
<pre><code>## [1] &quot;/ssd/personal/baller01/20200511_FernandesM_ME_crukBiSs2020/AnaWiSce/Ana1/Robjects/caron_sce_nz_postDeconv_5hCellPerSpl_denoised.Rds&quot;</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="dimensionality-reduction-for-analysis.html#cb27-1"></a><span class="kw">saveRDS</span>(sce, <span class="dt">file=</span>tmpFn)</span></code></pre></div>
<!-- http://bioinformatics.age.mpg.de/presentations-tutorials/presentations/modules/single-cell//bioconductor_tutorial.html -->
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="dimensionality-reduction-for-analysis.html#cb28-1"></a><span class="kw">rownames</span>(sce) &lt;-<span class="st"> </span><span class="kw">uniquifyFeatureNames</span>(<span class="kw">rowData</span>(sce)<span class="op">$</span>ensembl_gene_id, <span class="kw">rowData</span>(sce)<span class="op">$</span>Symbol)</span>
<span id="cb28-2"><a href="dimensionality-reduction-for-analysis.html#cb28-2"></a>pc1 &lt;-<span class="st"> </span><span class="kw">reducedDim</span>(sce, <span class="st">&quot;PCA&quot;</span>)[,<span class="dv">1</span>]</span>
<span id="cb28-3"><a href="dimensionality-reduction-for-analysis.html#cb28-3"></a>design &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>pc1)</span>
<span id="cb28-4"><a href="dimensionality-reduction-for-analysis.html#cb28-4"></a><span class="kw">library</span>(limma)</span>
<span id="cb28-5"><a href="dimensionality-reduction-for-analysis.html#cb28-5"></a>fit &lt;-<span class="st"> </span><span class="kw">lmFit</span>(<span class="kw">logcounts</span>(sce), design)</span>
<span id="cb28-6"><a href="dimensionality-reduction-for-analysis.html#cb28-6"></a>fit &lt;-<span class="st"> </span><span class="kw">eBayes</span>(fit, <span class="dt">trend=</span><span class="ot">TRUE</span>, <span class="dt">robust=</span><span class="ot">TRUE</span>)</span>
<span id="cb28-7"><a href="dimensionality-reduction-for-analysis.html#cb28-7"></a>topTab &lt;-<span class="st"> </span><span class="kw">topTable</span>(fit)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="dimensionality-reduction-for-analysis.html#cb29-1"></a><span class="kw">library</span>(pheatmap)</span>
<span id="cb29-2"><a href="dimensionality-reduction-for-analysis.html#cb29-2"></a>de.genes &lt;-<span class="st"> </span><span class="kw">rownames</span>(<span class="kw">topTable</span>(fit, <span class="dt">coef=</span><span class="dv">2</span>, <span class="dt">n=</span><span class="dv">50</span>))</span>
<span id="cb29-3"><a href="dimensionality-reduction-for-analysis.html#cb29-3"></a>heat.vals &lt;-<span class="st"> </span><span class="kw">logcounts</span>(sce)[de.genes,]</span>
<span id="cb29-4"><a href="dimensionality-reduction-for-analysis.html#cb29-4"></a>heat.vals &lt;-<span class="st"> </span>heat.vals <span class="op">-</span><span class="st"> </span><span class="kw">rowMeans</span>(heat.vals)</span>
<span id="cb29-5"><a href="dimensionality-reduction-for-analysis.html#cb29-5"></a>heat.vals[heat.vals <span class="op">&gt;</span><span class="st"> </span><span class="dv">2</span>] &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb29-6"><a href="dimensionality-reduction-for-analysis.html#cb29-6"></a>heat.vals[heat.vals <span class="op">&lt;</span><span class="st"> </span><span class="dv">-2</span>] &lt;-<span class="st"> </span><span class="dv">-2</span></span>
<span id="cb29-7"><a href="dimensionality-reduction-for-analysis.html#cb29-7"></a><span class="kw">pheatmap</span>(heat.vals[,<span class="kw">order</span>(pc1)], <span class="dt">cluster_cols=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="MkWoC_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="batch-correction-gsm3872442-set.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/dimRedForAna.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["MkWoC.pdf", "MkWoC.epub"],
"toc": {
"collapse": "subsection",
"scroll_highlight": true
},
"code_folding": "hide"
});
});
</script>

</body>

</html>
